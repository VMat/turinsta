<!--
  Generated template for the PublicationWritingPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
  <ion-navbar>
    <ion-item no-lines style="text-align: center">
      <button item-start ion-button clear (click)="dismissPublication()">
        <ion-icon name="close"></ion-icon>
      </button>
      <ion-title *ngIf="!publication._id">Nueva publicación</ion-title>
      <ion-title *ngIf="publication._id">Ver publicación</ion-title>
      <div *ngIf="checkEditPermission()" item-end>
        <button ion-button clear (click)="confirmDelete()">
          <ion-icon name="trash" color="danger"></ion-icon>
        </button>
      </div>
      <div *ngIf="publication._id == undefined" item-end>
        <button ion-button clear (click)="confirmSave()">
          <ion-icon name="checkmark" color="success"></ion-icon>
        </button>
      </div>
    </ion-item>
  </ion-navbar>
</ion-header>
<ion-content padding>
  <publication-header [user]=user [publication]=publication [edit]="checkEditPermission()" (changePlace)="setPlace($event)"></publication-header>
  <ion-slides>
    <ion-slide style="align-items: start" *ngFor="let image of publication.images">
      <div class="image-action-buttons" *ngIf="checkEditPermission()">
        <button ion-button icon-only clear (click)="addImage()">
          <ion-icon name="add" color="success"></ion-icon>
        </button>
        <button ion-button icon-only clear (click)="confirmDeleteImage()">
          <ion-icon name="remove" color="danger"></ion-icon>
        </button>
      </div>
      <publication-image [id]=image._id [url]=image.url></publication-image>
    </ion-slide>
  </ion-slides>
  <ion-item no-lines no-padding>
    <p *ngIf="publication.description" item-start class="publication-description"><b>{{user.username}}</b>&nbsp;{{publication.description}}</p>
    <div *ngIf="checkEditPermission() && publication.description" item-right>
      <button ion-button icon-only clear (click)="presentDescriptionWriting()">
        <ion-icon name="create"></ion-icon>
      </button>
      <button ion-button icon-only clear (click)="confirmDeleteDescription()">
        <ion-icon name="trash" color="danger"></ion-icon>
      </button>
    </div>
    <div *ngIf="checkEditPermission() && !publication.description" item-end>
      <button ion-button icon-only clear (click)="presentDescriptionWriting()">
        <ion-icon name="add" color="success"></ion-icon>
      </button>
    </div>
  </ion-item>
  <ion-item>
    <ion-item no-lines>
      <p>Experiencias (<span>{{experiences.length}}</span>)</p>
      <button item-end ion-button icon-only clear (click)="toogleExperienceList()">
        <ion-icon name="{{experienceListOpened ? 'ios-arrow-dropdown' : 'ios-arrow-dropright'}}"></ion-icon>
      </button>
    </ion-item>
    <experience-list *ngIf="experienceListOpened" [experiences]=experiences [publicationOwner]=user._id [publicationId]=publication._id></experience-list>
  </ion-item>
  <ion-item>
    <ion-item no-lines>
      <p>Comentarios (<span>{{comments.length}}</span>)</p>
      <button item-end ion-button icon-only clear (click)="toogleCommentList()">
        <ion-icon name="{{commentListOpened ? 'ios-arrow-dropdown' : 'ios-arrow-dropright'}}"></ion-icon>
      </button>
    </ion-item>
    <comment-list *ngIf="publication._id != undefined && commentListOpened" [comments]=comments [publicationId]=publication._id [publicationOwner]=user._id></comment-list>
  </ion-item>
</ion-content>
